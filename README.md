
# NEXUS LIGHT DESIGNER - OMEGA V33.5

## ðŸš€ CONFIGURAÃ‡ÃƒO DE BANCO DE DADOS (SUPABASE)

Para o sistema funcionar (Login, Chat, HistÃ³rico), vocÃª deve rodar este cÃ³digo no **SQL Editor** do seu novo projeto Supabase:

```sql
-- 1. Tabela de Perfis (Opcional, mas recomendada para seguranÃ§a)
create table if not exists profiles (
  id uuid references auth.users on delete cascade not null primary key,
  email text,
  full_name text,
  role text default 'operative',
  credits int default 50,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 2. Tabela de GeraÃ§Ãµes (HistÃ³rico de Imagens)
create table if not exists generations (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  prompt text,
  concept text,
  style text,
  mood text,
  image_url text,
  dna jsonb default '{}'::jsonb,
  performance jsonb default '{}'::jsonb,
  engine text default 'nexus-core',
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 3. Tabela de Chat (ColaboraÃ§Ã£o em Tempo Real)
create table if not exists nexus_chat (
  id bigint generated by default as identity primary key,
  text text,
  sender text, -- 'user', 'ai', 'system'
  user_id uuid references auth.users, -- Pode ser null se for mensagem de sistema
  user_name text,
  user_color text,
  attachment_name text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 4. Habilitar Row Level Security (SeguranÃ§a)
alter table profiles enable row level security;
alter table generations enable row level security;
alter table nexus_chat enable row level security;

-- 5. PolÃ­ticas de Acesso (Policies)

-- Perfis: Todos podem ver (para o chat funcionar), apenas dono edita
create policy "Public Profiles" on profiles for select using (true);
create policy "Users update own" on profiles for update using (auth.uid() = id);

-- GeraÃ§Ãµes: UsuÃ¡rio vÃª as suas, insere as suas
create policy "View Own Generations" on generations for select using (auth.uid() = user_id);
create policy "Create Generations" on generations for insert with check (auth.uid() = user_id);

-- Chat: Aberto para leitura/escrita (SimulaÃ§Ã£o de Sala PÃºblica)
create policy "Read Chat" on nexus_chat for select using (true);
create policy "Send Chat" on nexus_chat for insert with check (true);

-- 6. Trigger AutomÃ¡tico para criar Perfil ao se Cadastrar
create or replace function public.handle_new_user() 
returns trigger as $$
begin
  insert into public.profiles (id, email, full_name)
  values (new.id, new.email, new.raw_user_meta_data->>'full_name');
  return new;
end;
$$ language plpgsql security definer;

create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();
```

## ðŸ”‘ VARIÃVEIS DE AMBIENTE (VERCEL)

No painel da Vercel (Settings -> Environment Variables), adicione:

1. `VITE_SUPABASE_URL`: (Seu URL https://...supabase.co)
2. `VITE_SUPABASE_ANON_KEY`: (Sua chave pÃºblica eyJ...)
3. `VITE_GEMINI_API_KEY`: (Sua chave do Google AI Studio)
4. `VITE_FREEPIK_API_KEY`: (Sua chave da Freepik/Pikaso - Opcional)
5. `VITE_ADMIN_EMAIL`: (Seu email para acesso GOD MODE)

## ðŸ“¦ DEPLOY

```bash
git add .
git commit -m "Nexus Omega V33.5 Release"
git push origin main
```
